{"name":"mindnet","enabled":true,"description":"Mindnet to a party","type":"group","id":1,"items":[{"type":"alias","name":"Call mindnet toggle","enabled":true,"id":4,"matching":"exact","whole_words":true,"case_sensitive":false,"prefix_suffix":true,"actions":[{"action":"script","script":"client.mindnet_entered_group = [];\nclient.mindnet_left_group = [];"},{"action":"if","cond-type1":"variable","cond-val1":"@ameer_party_mindnet","cond-type2":"value","cond-val2":"1","cond-op":"eq","cond-mod":"","cond-cs":false,"dothen":"continue","doelse":"jump","dothenlabel":"","doelselabel":"else"},{"action":"variable","varname":"@ameer_party_mindnet","valtype":"value","value":"0","op":"set"},{"action":"notify","notice":"Mindnet reporting off","notice_fg":"#ff0000","notice_bg":"#000000"},{"action":"stop"},{"action":"label","label":"else"},{"action":"variable","varname":"@ameer_party_mindnet","valtype":"value","value":"1","op":"set"},{"action":"notify","notice":"Mindnet reporting on","notice_fg":"#ff0000","notice_bg":"#000000"}],"text":"pmn"},{"type":"trigger","name":"Mindnet capture","enabled":true,"id":2,"matching":"regexp","whole_words":true,"case_sensitive":true,"text":"^(\\w+) has (entered|left) the area\\.$","actions":[{"action":"variable","varname":"@ameer_mindnet_capture","valtype":"capture","value":"1","op":"set"},{"action":"if","cond-type1":"capture","cond-val1":"2","cond-type2":"value","cond-val2":"entered","cond-op":"eq","cond-mod":"","cond-cs":false,"dothen":"continue","doelse":"jump","dothenlabel":"","doelselabel":"else"},{"action":"script","script":"client.set_variable(\"citynet\", cdb_get_city(args[1]));\nvar person = client.get_variable(\"ameer_mindnet_capture\");\nclient.mindnet_entered_group.push(person);"},{"action":"stop"},{"action":"label","label":"else"},{"action":"script","script":"client.set_variable(\"citynet\", cdb_get_city(args[1]));\nvar person = client.get_variable(\"ameer_mindnet_capture\");\nclient.mindnet_left_group.push(person);"}]},{"type":"trigger","name":"Mindnet report","enabled":true,"id":5,"matching":"regexp","whole_words":true,"case_sensitive":true,"text":"^(\\d+)h, (\\d+)m,","actions":[{"action":"script","script":"var mindnet_type = get_variable(\"ameer_mindnet_type\");\nvar mindnet_activated = get_variable(\"ameer_party_mindnet\");\nvar area = get_variable(\"ameer_area\");\nvar citynet = client.get_variable(\"citynet\"); //Check for City\n\n\nif (mindnet_activated == 1 && (client.mindnet_entered_group.length > 0 || client.mindnet_left_group.length > 0)) { //Check if active\n    \n    //Report Entry\n\tif (client.mindnet_entered_group.length > 0) {\n    \tvar mindnet_entered_string = \"\";\n\t\tclient.mindnet_entered_group.forEach(function(item, index, array) {\n    \t    if (mindnet_entered_string == \"\") {\n            \tmindnet_entered_string = item\n            } \n            else {\n           \t \tmindnet_entered_string = mindnet_entered_string + \", \" + item;\n        \t}\n    \t});\n        \n        \t//Reporting\n        \tif (area == 'Targossas') {\n\n\t\t\t\tif (citynet == 'mhaldor' || citynet == 'hashan' || citynet == 'ashtan') {\n                \tsend_command(\"art \" + mindnet_entered_string + \" entered \" + area);\n                }\n            }\n        \n        \tif (citynet != 'targossas') {\n        \t\tsend_command(\"pt \" + mindnet_entered_string + \" entered \" + area);\n            }\n    }\n    \n    //Report Exit\n\tif (client.mindnet_left_group.length > 0) {\n    \tvar mindnet_left_string = \"\";\n\t\tclient.mindnet_left_group.forEach(function(item, index, array) {\n    \t    if (mindnet_left_string == \"\") {\n            \tmindnet_left_string = item\n        \t} \n            else {\n           \t \tmindnet_left_string = mindnet_left_string + \", \" + item;\n        \t}\n    \t});\n        \n        \t//Reporting\n            if (area == 'Targossas') {\n\n\t\t\t\tif (citynet == 'mhaldor' || citynet == 'hashan' || citynet == 'ashtan') {\n                \tsend_command(\"art \" + mindnet_left_string + \" left \" + area);\n                }\n            }\n        \n        \tif (citynet != 'targossas') {\n                send_command(\"pt \" + mindnet_left_string + \" left \" + area);\n            }\n    }\n}\n\nclient.mindnet_entered_group = [];\nclient.mindnet_left_group = [];"}]},{"type":"function","name":"onGMCP","enabled":true,"id":6,"code":"if (args.gmcp_method == \"Room.Info\") {\n   var tmpArea = args.gmcp_args.area\n   client.set_variable(\"ameer_area\", tmpArea);\n}"},{"type":"function","name":"onLoad","enabled":true,"id":7,"code":"client.mindnet_entered_group = [];\nclient.mindnet_left_group = [];\nclient.ameer_area = \"\";"}]}