{"name":"fullsense","enabled":true,"description":"Fullsense to party","type":"group","id":1,"items":[{"type":"alias","name":"Fullsense party alias","enabled":true,"id":4,"matching":"exact","whole_words":true,"case_sensitive":false,"prefix_suffix":true,"actions":[{"action":"command","command":"fullsense","prefix_suffix":true},{"action":"variable","varname":"@ameer_fullsense_command","valtype":"value","value":"1","op":"set"},{"action":"script","script":"client.fullsense_group = {};"}],"text":"pfs"},{"type":"trigger","name":"Full sense capture enabled","enabled":true,"id":3,"matching":"exact","whole_words":true,"case_sensitive":true,"text":"You seek out all mental presences within your reach:","actions":[{"action":"if","cond-type1":"variable","cond-val1":"@ameer_fullsense_command","cond-type2":"value","cond-val2":"1","cond-op":"eq","cond-mod":"","cond-cs":false,"dothen":"continue","doelse":"stop","dothenlabel":"","doelselabel":""},{"action":"variable","varname":"@ameer_fullsense","valtype":"value","value":"1","op":"set"},{"action":"variable","varname":"@ameer_fullsense_command","valtype":"value","value":"0","op":"set"},{"action":"notify","notice":"INITIATING FULLSENSE!","notice_fg":"#000000","notice_bg":"#ffff00"}]},{"type":"trigger","name":"Capturing names","enabled":true,"id":5,"matching":"regexp","whole_words":true,"case_sensitive":true,"text":"^You sense (\\w+) at (.+)\\.$","actions":[{"action":"if","cond-type1":"variable","cond-val1":"@ameer_fullsense","cond-type2":"value","cond-val2":"1","cond-op":"eq","cond-mod":"","cond-cs":false,"dothen":"continue","doelse":"stop","dothenlabel":"","doelselabel":""},{"action":"variable","varname":"@ameer_fullsense_name","valtype":"capture","value":"1","op":"set"},{"action":"variable","varname":"@ameer_fullsense_room","valtype":"capture","value":"2","op":"set"},{"action":"script","script":"var fullsense_target = get_variable(\"ameer_fullsense_name\");\nvar fullsense_room = get_variable(\"ameer_fullsense_room\");\n\nif (client.fullsense_group[fullsense_room] == undefined) {\n    client.fullsense_group[fullsense_room] = [];\n}\n\nclient.fullsense_group[fullsense_room].push(fullsense_target);\n\n"}]},{"type":"trigger","name":"","enabled":true,"id":7,"matching":"regexp","whole_words":true,"case_sensitive":true,"text":"^(\\d+)h, (\\d+)m,","actions":[{"action":"script","script":"var ameer_fullsense = get_variable(\"ameer_fullsense\");\nvar ameer_area = get_variable(\"ameer_area\");\n    \nif (ameer_fullsense == 1) \n{\n    for (let key in fullsense_group) {\n        send_command(\"pt [\" + key + \", (\" + fullsense_group[key].length + \")]: \" + fullsense_group[key].toString().replace(/,/g , ', '))\n    }   \n    client.set_variable(\"ameer_fullsense\", 0)\n};"}]},{"type":"function","name":"onLoad","enabled":true,"id":8,"code":"client.fullsense_group = {};"},{"type":"function","name":"onGMCP","enabled":true,"id":9,"code":"if (args.gmcp_method == \"Room.Info\") {\n   var tmpArea = args.gmcp_args.area\n   client.set_variable(\"ameer_area\", tmpArea);\n}\n"}]}